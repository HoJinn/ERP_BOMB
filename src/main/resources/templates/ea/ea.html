<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5" lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="shortcut icon" th:href="@{/uses/Logo.png}">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans&family=Noto+Sans+KR:wght@100&display=swap">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.9/css/select2.min.css" rel="stylesheet" />
<link th:href="@{/uses/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet" type="text/css">
<link th:href="@{/uses/css/sb-admin-2.min.css}" rel="stylesheet">
<link th:href="@{/uses/vendor/datatables/dataTables.bootstrap4.min.css}" rel="stylesheet">
<link rel="stylesheet" th:href="@{/css/common/header.css}">
<link rel="stylesheet" th:href="@{/css/ea/ea.css}">	<!-- 여기에 페이지 css파일 적용 -->
<title>ERP BOMB</title>
</head>
<body>

	<!-- header -->
	<header id="top">
		<th:block th:include="common/header"/>
	</header>

	<section>
		<nav class="navbar navbar-expand-sm navbar-light bg-light">
			<a class="navbar-brand font-weight-bold" href="/">
				<img th:src="@{/uses/logo_new.png}" alt="" class="logo">
			</a>
			<div class="collapse navbar-collapse function-tab">
				<ul class="navbar-nav mr-3 top-tap">
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="shoes/list">메인 페이지</a>
					</li>
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="resell/resellList">게시판</a>
					</li>
					<li class="nav-item mr-3 tab-selected">
						<a class="nav-link font-weight-bold" href="resell/resellList">전자결재</a>
					</li>
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="resell/resellList">급여관리</a>
					</li>
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="resell/resellList">퇴직금</a>
					</li>
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="resell/resellList">재고 관리</a>
					</li>
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="resell/resellList">근태 관리</a>
					</li>
					<li class="nav-item mr-3">
						<a class="nav-link font-weight-bold" href="resell/resellList">입출고</a>
					</li>
				</ul>
			</div>
		</nav>
		<hr class="m-0">
		<div id="wrapper">

			<!-- Sidebar -->
			<ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

				<!-- Sidebar - Brand -->
				<a class="sidebar-brand" href="${ pageContext.servletContext.contextPath }/myPage/drawHistory">
					<div class="sidebar-brand-icon rotate-n-15">
					</div>
					<div class="sidebar-brand-text mx-3">전자결재</div>
				</a>

				<!-- Divider -->
				<hr class="sidebar-divider my-0">

				<!-- Divider -->
				<hr class="sidebar-divider">

				<!-- Nav Item - Pages Collapse Menu -->
				<li class="nav-item">
					<a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
						aria-expanded="true" aria-controls="collapseUtilities">
						<span>전자결재</span>
					</a>
				</li>

				<hr class="sidebar-divider">
			</ul>
			<!-- End of Sidebar -->

			<div id="content-wrapper" class="d-flex flex-column">
				<div style="width: 80%;" class="">
					<!-- 여기부터 전자 결재 리스트 -->
					<div class="">

						<div class="search_form">
							<input type="text" placeholder="검색어 입력" />
							<button type="button" class="blue_btn">Search</button>
						</div>
						<ul class="tab ul-tab">
							<li class="li-tab electronic_approval on" data-tab="myEaList"><span>내 기안</span></li>
							<li class="li-tab electronic_approval" data-tab="myEaPathList"><span>참조 기안</span></li>
							<li class="li-tab electronic_approval" data-tab="myEaCarbonList"><span>결재 기안</span></li>
						</ul>
						<div id="myEaList" class="tab_contents electronic_approval current">
							<div class="tableArea">
								<table>
									<caption>보낸쪽지 리스트</caption>
									<colgroup>
										<col style="width:10%" />
										<col style="width:8%" />
										<col style="width:50%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
									</colgroup>
									<thead>
										<tr>
											<th>번호</th>
											<th>기안일자</th>
											<th>제목</th>
											<th>기안자</th>
											<th>결재자</th>
											<th>결재 상태</th>
											<th>기안서 복사</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="list : ${ myEaList }">
											<td th:text="${ list.serialNo }"></td>
											<td th:text="${ list.date }"></td>
											<td th:text="${ list.title}" class="t_left pop_btn" th:attr="data-button=${ 'approval_detail_pop' + list.serialNo }"></td>
											<td th:text="${ list.member.name }"></td>
											<th:block th:each="path : ${ list.eaApprovalPathList }" th:if="${ path.status == 4}">
												<td th:text="${ path.member.name }"></td>
											</th:block>
											<th:block th:switch="${ list.category }">
												<td th:case="1">결재 중</td>
												<td th:case="2">결재 완료</td>
												<td th:case="3">결재 반려</td>
												<td th:case="4">임시 저장</td>
											</th:block>
											<td class="copy-approval pop_btn" data-button="approval_copy_pop1">복사</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div id="myEaPathList" class="tab_contents electronic_approval">
							<div class="tableArea">
								<table>
									<caption>보낸쪽지 리스트</caption>
									<colgroup>
										<col style="width:10%" />
										<col style="width:8%" />
										<col style="width:50%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
									</colgroup>
									<thead>
										<tr>
											<th>번호</th>
											<th>기안일자</th>
											<th>제목</th>
											<th>기안자</th>
											<th>결재자</th>
											<th>결재 상태</th>
											<th>기안서 복사</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>3</td>
											<td>2021/11/07</td>
											<td class="t_left pop_btn" data-button="approval_detail_pop3">기안 중 기안입니다.
											</td>
											<td>황성연</td>
											<td></td>
											<td>기안 중</td>
											<td class="copy-approval pop_btn" data-button="approval_copy_pop3">복사</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div id="myEaCarbonList" class="tab_contents electronic_approval">
							<div class="tableArea">
								<table>
									<caption>보낸쪽지 리스트</caption>
									<colgroup>
										<col style="width:10%" />
										<col style="width:8%" />
										<col style="width:50%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
									</colgroup>
									<thead>
										<tr>
											<th>번호</th>
											<th>기안일자</th>
											<th>제목</th>
											<th>기안자</th>
											<th>결재자</th>
											<th>결재 상태</th>
											<th>기안서 복사</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>1</td>
											<td>2021/11/07</td>
											<td class="t_left pop_btn" data-button="approval_detail_pop1">결재 중 기안입니다.
											</td>
											<td>황성연</td>
											<td>황성연</td>
											<td>결재 중</td>
											<td class="copy-approval pop_btn" data-button="approval_copy_pop1">복사</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div id="confirm_approval" class="tab_contents electronic_approval">
							<div class="tableArea">
								<table>
									<caption>보낸쪽지 리스트</caption>
									<colgroup>
										<col style="width:10%" />
										<col style="width:8%" />
										<col style="width:50%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
									</colgroup>
									<thead>
										<tr>
											<th>번호</th>
											<th>기안일자</th>
											<th>제목</th>
											<th>기안자</th>
											<th>결재자</th>
											<th>결재 상태</th>
											<th>기안서 복사</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>2</td>
											<td>2021/11/07</td>
											<td class="t_left pop_btn" data-button="approval_detail_pop2">결재 완료 기안입니다.
											</td>
											<td>황성연</td>
											<td>김가희</td>
											<td>결재 완료</td>
											<td class="copy-approval pop_btn" data-button="approval_copy_pop2">복사</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div id="return_approval" class="tab_contents electronic_approval">
							<div class="tableArea">
								<table>
									<caption>보낸쪽지 리스트</caption>
									<colgroup>
										<col style="width:10%" />
										<col style="width:8%" />
										<col style="width:50%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
										<col style="width:8%" />
									</colgroup>
									<thead>
										<tr>
											<th>번호</th>
											<th>기안일자</th>
											<th>제목</th>
											<th>기안자</th>
											<th>결재자</th>
											<th>결재 상태</th>
											<th>기안서 복사</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>4</td>
											<td>2021/11/07</td>
											<td class="t_left pop_btn" data-button="approval_detail_pop4">반려 기안입니다.</td>
											<td>황성연</td>
											<td>김성민</td>
											<td>반려</td>
											<td class="copy-approval pop_btn" data-button="approval_copy_pop4">복사</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div class="btn_area">
							<a  class="blue_btn pop_btn" data-button="new_approval_pop">신규</a>
						</div>
					</div>
					<!-- 여기까지 전자 결재 리스트 -->

					<!-- 여기부터 신규 전자 결재 팝업 -->
					<div id="new_approval_pop" class="pop_layer">
						<div class="top_area">
							<h2>신규 결재</h2>
							<button type="button" class="pop_close" data-button="new_approval_pop">닫기</button>
						</div>
						<form id="new_approval_form" method="post" action="/ea/regNewEa">
							<div class="pop_inner">
								<div class="line-div">
									제&nbsp; 목&nbsp;&nbsp;&nbsp;
									<input name="title" placeholder="제목을 입력해주세요." style="width: 91.5%;" type="text">
									<br>
								</div>
								<div class="mt-2 line-div">
									결재자&nbsp;
									<select name="approvaler" id="new_approvaler" style="width: 91.5%;" class="form-control select2" multiple="multiple">
										<option th:each="member : ${ memberList }" th:text="${ member.name }"></option>
									</select>
									<br>
								</div>
								<div class="mt-2 line-div">
									참조자&nbsp;
									<select name="carboner" id="new_carboner" style="width: 91.5%;" class="form-control select2" multiple="multiple">
										<option th:each="member : ${ memberList }" th:text="${ member.name }"></option>
									</select>
									<br>
								</div>
								<textarea name="content" class="approval_content_text"></textarea>
							</div>
							<div class="btn_area">
								<a id="new_approval" class="blue_btn pop_close">결재</a>
								<a id="temp_approval" class="blue_btn pop_close">임시 저장</a>
								<a class="gray_btn pop_close" data-button="new_approval_pop">닫기</a>
							</div>
						</form>
					</div>
					<!-- 여기까지 신규 전자 결재 팝업 -->

					<!-- 여기부터 전자 결재 디테일 팝업 -->
					<div th:each="list : ${ myEaList }" style="overflow: scroll; height: 700px; top: 50%;" th:attr="id=${ 'approval_detail_pop' + list.serialNo }" class="pop_layer approval_detail">
						<div class="top_area">
							<h2>전자 결재</h2>
							<button type="button" class="pop_close" th:attr="data-button=${ 'approval_detail_pop' + list.serialNo }">닫기</button>
						</div>
						<h2 class="approval_title mt-3" th:text="${ list.title }"></h2>
						<table class="approval_line" border="1">
							<tr>
								<td rowspan="3">결재</td>
								<td th:utext="${list.member.rank.name}+'<br>'+${list.member.name}" class="approval_person"></td>
								<td th:each="eaPath : ${list.eaApprovalPathList}" th:utext="${eaPath.member.rank.name}+'<br>'+${eaPath.member.name}" class="approval_person"></td>
							</tr>
							<tr class="approval_status">
								<td th:text="결재"></td>
								<th:block th:each="eaPath : ${list.eaApprovalPathList}" th:switch="${ eaPath.status }">
										<td th:case="1" class="approval_person"></td>
										<td th:case="2" class="approval_person">반려</td>
										<td th:case="3" class="approval_person">결재</td>
										<td th:case="*" class="approval_person"></td>
								</th:block>
							</tr>
							<tr>
								<td th:text="${ #dates.format(list.date, 'yyyy/MM/dd') }" class="approval_person"></td>
								<td th:each="eaPath : ${list.eaApprovalPathList}" th:text="${ #dates.format(eaPath.date, 'yyyy/MM/dd') }">2021/22/22</td>
							</tr>
						</table>
						<div style="border: solid #ccc 1px; margin: 0px 10px; padding: 0px 1px;">
							<div style="display: inline-block; color: white; background-color: #8cceea; height: 31px; width: 80px; text-align: center; line-height: 30px;">
								참조자
							</div>
							<div style="display: inline-block;">
								<span style="color: black;">
									<th:block th:each="carbon : ${ list.eaCarbonList }">
										<th:block th:utext="${carbonStat.first}?${carbon.member.name}:', '+${carbon.member.name}"><th:block>
									</th:block>
								</span>
							</div>
						</div>
						<div class="pop_inner">
							<div class="detail_note">
								<div class="top">
									<p class="name">기안 일자</p>
									<p th:utext="${ #dates.format(list.date, 'yyyy/MM/dd') } + '&nbsp;&nbsp' + ${ #dates.format(list.date, 'hh:mm:ss') }" class="date">2021/11/07 11:17:01</p>
								</div>

								<div class="approval_content">
									<p th:utext="${#strings.replace(list.content,'
','<br>')} "></p>
								</div>
							</div>
						</div>
						<div class="comment_area" style="margin: 0px 10px; margin-bottom: 10px;">
							<div th:each="ad : ${ list.addendumList }" class="row m-0 comment" style="padding: 2px 10px; border: solid #ccc 1px; border-radius: 1em; margin-bottom: 5px !important;" th:attr="id=${ 'addendum' + ad.no}">
								<th:block th:if="${ ad.depth != 0 }">
									<th:block th:each="num : ${#numbers.sequence(1, ad.depth)}">
										<div th:if="${ numStat.last == false }" class="col-1"></div>
										<div th:unless="${ numStat.last == false }" style="display: flex; align-items: center;" class="col-1 p-0"><img th:src="@{/uses/pngwing.com.png}" style="max-height: 20px; margin-left: auto; margin-right: auto;"></div>
									</th:block>
								</th:block>
								<div style="height: auto;" class="col">
									<span th:if="${ list.member.name == ad.member.name }" th:utext="${ ad.member.name } + '&nbsp;(기안자)'" style="color: black;"></span>
									<span th:unless="${ list.member.name == ad.member.name }" th:utext="${ ad.member.name }" style="color: black;"></span>
									<button class="ml-3 reply_btn pop_btn" style="font-size: 13px;" data-button="reply_comment_pop" th:attr="name=${ ad.no }">답글</button>
									<button class="ml-3 delete_btn" style="font-size: 13px;" th:attr="id=${'commentDelete' + ad.no}">삭제</button>
									<b th:text="${ ad.date }" style="color: black; float: right;"></b>
									<p  style="font-size: 13px;" class="m-0" th:utext="${#strings.replace(ad.content,'
','<br>')} "></p>
								</div>
							</div>
						</div>
						<div class="btn_area">
							<a class="blue_btn">결재 취소</a>
							<a class="gray_btn pop_btn" data-button="new_comment_pop">첨언</a>
							<a class="gray_btn pop_close" th:attr="data-button=${ 'approval_detail_pop' + list.serialNo }">닫기</a>
						</div>
						
					</div>
					<!-- 여기까지 전자 결재 디테일 팝업 -->

					<!-- 여기부터 전자 결재 디테일 팝업 -->
					<div style="overflow: scroll; height: 700px; top: 50%;" id="approval_detail_pop2" class="pop_layer approval_detail">
						<div class="top_area">
							<h2>전자 결재</h2>
							<button type="button" class="pop_close" data-button="approval_detail_pop2">닫기</button>
						</div>
						<h2 class="approval_title mt-3">결재 완료 기안입니다.</h2>
						<table class="approval_line" border="1">
							<tr>
								<td rowspan="4">결재</td>
								<td class="approval_person">사원<br>황성연</td>
								<td class="approval_person">과장<br>최유정</td>
								<td class="approval_person">이사<br>김성민</td>
								<td class="approval_person">사장<br>김가희</td>
							</tr>
							<tr class="approval_status">
								<td>결재</td>
								<td>결재</td>
								<td>결재</td>
								<td>결재</td>
							</tr>
							<tr>
								<td>21/11/09</td>
								<td>21/11/09</td>
								<td>21/11/10</td>
								<td>21/11/12</td>
							</tr>
						</table>
						<div style="border: solid #ccc 1px; margin: 0px 10px; padding: 0px 1px;">
							<div style="display: inline-block; color: white; background-color: #8cceea; height: 31px; width: 80px; text-align: center; line-height: 30px;">
								참조자
							</div>
							<div style="display: inline-block;">
								<span style="color: black;">김지혁, 최호진</span>
							</div>
						</div>
						<div class="pop_inner">
							<div class="detail_note">
								<div class="top">
									<p class="name">기안 일자</p>
									<p class="date">2021/11/07 11:17:01</p>
								</div>
								<div class="approval_content">
									<p>
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
									</p>
								</div>
							</div>
						</div>
						<div class="btn_area">
							<a class="gray_btn">첨언</a>
							<a class="gray_btn pop_close" data-button="approval_detail_pop2">닫기</a>
						</div>
					</div>
					<!-- 여기까지 전자 결재 디테일 팝업 -->

					<!-- 여기부터 전자 결재 디테일 팝업 -->
					<div style="overflow: scroll; height: 700px; top: 50%;" id="approval_detail_pop3" class="pop_layer approval_detail">
						<div class="top_area">
							<h2>전자 결재</h2>
							<button type="button" class="pop_close" data-button="approval_detail_pop3">닫기</button>
						</div>
						<h2 class="approval_title mt-3">기안 중 기안입니다.</h2>
						<div class="line-div ml-2">
							결재자&nbsp;
							<select style="width: 91.5%;" class="form-control select2" multiple="multiple">
								<option selected>황성연</option>
								<option>최유정</option>
								<option>김종현</option>
								<option selected>김성민</option>
								<option selected>최호진</option>
								<option>김지혁</option>
								<option selected>김가희</option>
							</select>
							<br>
						</div>
						<div class="mt-2 line-div ml-2">
							참조자&nbsp;
							<select style="width: 91.5%;" class="form-control select2" multiple="multiple">
								<option th:each="member : ${ memberList }" th:text="${ member.name }"></option>
							</select>
							<br>
						</div>
						<div class="pop_inner">
							<div class="detail_note">
								<div class="top">
									<p class="name">기안 일자</p>
									<p class="date">2021/11/07 11:17:01</p>
								</div>
								<div class="approval_content">
									<textarea>테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트</textarea>
								</div>
							</div>
						</div>
						<div class="btn_area">
							<a class="blue_btn">결재</a>
							<a class="blue_btn">수정</a>
							<a class="blue_btn">삭제</a>
							<a class="gray_btn">첨언</a>
							<a class="gray_btn pop_close" data-button="approval_detail_pop3">닫기</a>
						</div>
					</div>
					<!-- 여기까지 전자 결재 디테일 팝업 -->

					<!-- 여기부터 전자 결재 디테일 팝업 -->
					<div style="overflow: scroll; height: 700px; top: 50%;" id="approval_detail_pop4" class="pop_layer approval_detail">
						<div class="top_area">
							<h2>전자 결재</h2>
							<button type="button" class="pop_close" data-button="approval_detail_pop4">닫기</button>
						</div>
						<h2 class="approval_title mt-3">반려 기안입니다.</h2>
						<table class="approval_line" border="1">
							<tr>
								<td rowspan="4">결재</td>
								<td class="approval_person">사원<br>황성연</td>
								<td class="approval_person">과장<br>최유정</td>
								<td class="approval_person">이사<br>김성민</td>
								<td class="approval_person">사장<br>김가희</td>
							</tr>
							<tr class="approval_status">
								<td>결재</td>
								<td>결재</td>
								<td>반려</td>
								<td></td>
							</tr>
							<tr>
								<td>21/11/09</td>
								<td>21/11/09</td>
								<td>21/11/10</td>
								<td></td>
							</tr>
						</table>
						<div style="border: solid #ccc 1px; margin: 0px 10px; padding: 0px 1px;">
							<div style="display: inline-block; color: white; background-color: #8cceea; height: 31px; width: 80px; text-align: center; line-height: 30px;">
								참조자
							</div>
							<div style="display: inline-block;">
								<span style="color: black;">김지혁, 최호진</span>
							</div>
						</div>
						<div class="pop_inner">
							<div class="detail_note">
								<div class="top">
									<p class="name">기안 일자</p>
									<p class="date">2021/11/07 11:17:01</p>
								</div>
								<div class="approval_content">
									<p>
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
										테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트테스트
									</p>
								</div>
							</div>
						</div>
						<div class="btn_area">
							<a class="gray_btn">첨언</a>
							<a class="gray_btn pop_close" data-button="approval_detail_pop4">닫기</a>
						</div>
					</div>
					<!-- 여기까지 전자 결재 디테일 팝업 -->
				</div>
			</div>
		</div>
		
		<!-- 여기부터 신규 첨언 팝업 -->
		<div id="new_comment_pop" class="pop_layer new_comment_pop">
			<div class="top_area">
				<h2>신규 첨언</h2>
				<button type="button" class="pop_close" data-button="new_comment_pop">닫기</button>
			</div>
			<div class="pop_inner">
				<textarea class="commnet_content_text"></textarea>
			</div>
			<div class="btn_area">
				<a class="blue_btn add_comment" data-button="new_comment_pop">작성</a>
				<a class="gray_btn pop_close close_comment" data-button="new_comment_pop">닫기</a>
			</div>
		</div>
		<!-- 여기까지 신규 첨언 팝업 -->
		
		<!-- 여기부터 답글 첨언 팝업 -->
		<div id="reply_comment_pop" class="pop_layer new_comment_pop">
			<div class="top_area">
				<h2>답글 첨언</h2>
				<button type="button" class="pop_close close_reply" data-button="new_comment_pop">닫기</button>
			</div>
			<div class="pop_inner">
				<textarea id="reply_content" class="commnet_content_text"></textarea>
			</div>
			<div class="btn_area">
				<a class="blue_btn pop_close reply_comment" data-button="reply_comment_pop">작성</a>
				<a class="gray_btn pop_close close_reply" data-button="reply_comment_pop">닫기</a>
			</div>
		</div>
		<!-- 여기까지 답글 첨언 팝업 -->
	</section>
	<script>
		$(document).ready(function () {
			var $reply;
			var $eaNo;
			$(".reply_btn").click(function() {
				$reply = $(this).attr("name");
			});
		
			$("#new_approval").click(function() {
				$("#new_approval_form").submit();
			});
			
			$('.select2').select2({
				placeholder: "선택 해주세요",
			});
			
			$(".select2").on("select2:select", function (evt) {
				var element = evt.params.data.element;
				var $element = $(element);
				
				if ($(this).find(":selected").length > 1) {
				  var $second = $(this).find(":selected").eq(-1);
				  $second.after($element);
				} else {
				  $element.detach();
				  $(this).prepend($element);
				}
				
				$(this).trigger("change");
	        });
			
			var replyAd = function() {
				let $reply_content = $("#reply_content").val();
				$.ajax({
					url: "/ea/replyAddendum",
					data: {no : $reply,
						   content : $reply_content},
					success:function(data) {
						let $refAd = $("#addendum" + data.refNo.no);
						data.content = data.content.replace(/(?:\r\n|\r|\n)/g, "<br>");
						
						let $text = '<div class="row m-0 comment" style="padding: 2px 10px; border: solid #ccc 1px; border-radius: 1em; margin-bottom: 5px !important;" id=addendum' + data.no + '>';
						for(let i = 1 ; i <= data.depth ; i++) {
							if(i == data.depth) {
								$text += '<div style="display: flex; align-items: center;" class="col-1 p-0"><img src="/uses/pngwing.com.png" style="max-height: 20px; margin-left: auto; margin-right: auto;"></div>';
							} else {
								$text += '<div class="col-1"></div>';
							}
						}
						$text += '<div style="height: auto;" class="col">';
						if(data.ea.member.name == data.member.name) {
							$text += '<span style="color: black;">' + data.member.name + '&nbsp;(기안자)' + '</span>';
						} else {
							$text += '<span style="color: black;">' + data.member.name + '</span>';
						}
						$text += '<button class="ml-3 reply_btn pop_btn" style="font-size: 13px;" id="adReplyBtn' + data.no + '" data-button="reply_comment_pop" name="' + data.no + '">답글</button>';
						$text += '<button class="ml-3 delete_btn" style="font-size: 13px;" id="commentDelete' + data.no + '">삭제</button>';
						$text += '<b style="color: black; float: right;">' + data.date + '</b>';
						$text += '<p  style="font-size: 13px;" class="m-0">' + data.content + '</p>';
						$text += '</div>';
						
						$refAd.after($text);
						$("#commentDelete" + data.no).click( deleteAd );
						$("#adReplyBtn" + data.no).click(function() {
							var pop_name = $(this).data('button');
							
							$reply = $(this).attr("name");

							$('#' + pop_name).stop().toggle();
							var window_w = $(window).width();
							$('.pop_layer').each(function (index, item) {
								$(item).addClass('pop_0' + index);

								var pop_width = $('.pop_0' + index).width();
								var pop_height = $('.pop_0' + index).height();

								$('.pop_0' + index).css({
									'margin-left': -(pop_width / '2'),
									'margin-top': -(pop_height / '2')
								});
							});
							
							$('.payroll_pop_layer').each(function (index, item) {
								$(item).addClass('pop_0' + index);

								var pop_width = $('.pop_0' + index).width();
								var pop_height = $('.pop_0' + index).height();

								$('.pop_0' + index).css({
									'margin-left': -(pop_width / '2'),
									'margin-top': -(pop_height / '2')
								});
							});
						});
						$("#reply_content").val('');
					},
					error:function(error){
						alert('답글 작성에 실패하셨습니다.');
					}
				});
			}
			$(".reply_comment").click(replyAd);
			
			var deleteAd = function() {
				let $this = $(this);
				console.log($this);
				let data = $this.attr('id').replace('commentDelete', '');
				$.ajax({
					url: "/ea/deleteAddendum",
					data: {no : data},
					success:function(data) {
						$this.parent().parent(".comment").remove('');
					},
					error:function(error){
						alert("답글이 달런 첨언은 삭제할 수 없습니다.");
					}
				});
			}
			$(".delete_btn").click( deleteAd );
			
			$(".close_reply").click(function(){
				$(this).parent().prev().children().val("");
			});
	
			$(".close_comment").click(function() {
				$(this).parent().prev().children().val("");
			});
	
			$(".add_comment").click(function() {
				let nowDate = new Date();
				let $writer = "작성자";
				let $content = $(this).parent().prev().children().val();
				let newDate = nowDate.getFullYear() + "-" + (nowDate.getMonth() + 1) + "-" + nowDate.getDate();
				let $div = '<div class="row m-0 comment" style="padding: 2px 10px; border: solid #ccc 1px; border-radius: 1em; margin-bottom: 5px !important;"><div style="height: auto;" class="col"><span style="color: black;">' + $writer + '</span><button class="ml-3 reply_btn" style="font-size: 13px;">답글</button><button class="ml-3 delete_btn" style="font-size: 13px;">삭제</button><b style="color: black; float: right;">' + newDate + '</b><p style="font-size: 13px;" class="m-0">' + $content + '</p></div></div>'
	
				$(this).parent().prev().children().val("");
	
				$(this).parent().parent().prevAll(".comment_area").last().append($div);
				
				$(".delete_btn").click(function() {
					$(this).parent().parent(".comment").remove();
				});
			});
		});
	</script>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.9/js/select2.min.js"></script>
</body>
</html>